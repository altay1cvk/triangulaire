<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üëë ULTIMATE PRO SYSTEM | GitHub Final</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Rajdhani:wght@600;700&family=Roboto+Mono:wght@500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00ff88;
            --secondary: #00d4ff;
            --accent: #ff0080;
            --warning: #ffaa00;
            --purple: #8844ff;
            --gold: #ffd700;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Rajdhani', sans-serif; background: #000; color: #fff; overflow-x: hidden; }
        .container { max-width: 2600px; margin: 0 auto; padding: 15px; }
        .header { background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(136,68,255,0.2), rgba(0,255,136,0.2)); border: 4px solid var(--gold); border-radius: 25px; padding: 40px; margin-bottom: 15px; text-align: center; box-shadow: 0 0 120px rgba(255,215,0,0.8); animation: glow 4s infinite; }
        @keyframes glow { 0%,100% { box-shadow: 0 0 100px rgba(255,215,0,0.8); } 50% { box-shadow: 0 0 160px rgba(255,215,0,1); } }
        h1 { font-family: 'Orbitron', sans-serif; font-size: 4rem; background: linear-gradient(90deg, var(--gold), var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 15px; }
        .subtitle { font-size: 1.2rem; color: var(--gold); margin-bottom: 20px; }
        .controls { display: flex; justify-content: center; gap: 20px; margin: 20px 0; }
        .btn-control { padding: 15px 40px; font-family: 'Orbitron', sans-serif; font-size: 1.2rem; font-weight: 900; border: none; border-radius: 15px; cursor: pointer; transition: all 0.3s; text-transform: uppercase; }
        .btn-start { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: #000; box-shadow: 0 0 30px rgba(0,255,136,0.5); }
        .btn-start:hover:not(:disabled) { transform: scale(1.05); }
        .btn-start:disabled { background: #333; color: #666; cursor: not-allowed; }
        .btn-stop { background: linear-gradient(135deg, var(--accent), #f33); color: #fff; box-shadow: 0 0 30px rgba(255,0,128,0.5); }
        .btn-stop:hover:not(:disabled) { transform: scale(1.05); }
        .btn-stop:disabled { background: #333; color: #666; cursor: not-allowed; }
        .status-indicator { display: inline-block; padding: 10px 25px; border-radius: 15px; font-weight: 700; margin: 10px 0; }
        .status-indicator.running { background: rgba(0,255,136,0.2); border: 2px solid var(--primary); color: var(--primary); animation: pulse 2s infinite; }
        .status-indicator.stopped { background: rgba(255,0,128,0.2); border: 2px solid var(--accent); color: var(--accent); }
        @keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.7; } }
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-top: 20px; }
        .feature-badge { padding: 10px 18px; background: linear-gradient(135deg, var(--gold), var(--warning)); color: #000; border-radius: 15px; font-weight: 900; font-size: 0.85rem; text-align: center; }
        .main-grid { display: grid; grid-template-columns: 400px 1fr 450px; gap: 15px; margin-top: 20px; }
        .card { background: #0a0a0a; border: 2px solid #1a1a1a; border-radius: 15px; padding: 20px; }
        .card h3 { font-family: 'Orbitron', sans-serif; font-size: 1.2rem; margin-bottom: 15px; text-align: center; }
        .progress-card { border: 3px solid var(--gold); box-shadow: 0 0 50px rgba(255,215,0,0.4); }
        .capital-display { text-align: center; margin-bottom: 15px; }
        .capital-display .value { font-family: 'Orbitron', sans-serif; font-size: 3rem; font-weight: 900; color: var(--gold); text-shadow: 0 0 30px rgba(255,215,0,0.8); }
        .progress-bar { width: 100%; height: 30px; background: rgba(255,255,255,0.05); border-radius: 15px; overflow: hidden; margin-bottom: 10px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--gold), var(--primary), var(--secondary)); transition: width 1s; background-size: 300%; animation: shine 3s linear infinite; }
        @keyframes shine { 0% { background-position: -300% 0; } 100% { background-position: 300% 0; } }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 15px; }
        .stat-box { background: rgba(0,0,0,0.6); border: 2px solid #1a1a1a; border-radius: 10px; padding: 12px; text-align: center; }
        .stat-box .label { font-size: 0.75rem; color: #888; margin-bottom: 6px; }
        .stat-box .value { font-family: 'Roboto Mono', monospace; font-weight: 700; color: var(--gold); font-size: 1.1rem; }
        .console-card { height: 350px; }
        .console { height: calc(100% - 50px); background: #000; border: 1px solid #1a1a1a; border-radius: 8px; padding: 10px; overflow-y: auto; font-family: 'Roboto Mono', monospace; font-size: 0.7rem; }
        .log { margin-bottom: 4px; line-height: 1.4; }
        .log .time { color: #666; }
        .log.info { color: var(--secondary); }
        .log.success { color: var(--primary); }
        .log.warning { color: var(--warning); }
        .log.error { color: var(--accent); }
        .log.telegram { color: var(--secondary); font-weight: 700; background: rgba(0,212,255,0.15); padding: 4px; border-radius: 3px; }
        .signals-card { border: 3px solid var(--gold); box-shadow: 0 0 50px rgba(255,215,0,0.4); }
        .signals-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(360px, 1fr)); gap: 15px; max-height: 550px; overflow-y: auto; }
        .signal-card { background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(136,68,255,0.1)); border: 3px solid var(--gold); border-radius: 15px; padding: 20px; position: relative; }
        .signal-card.elite::before { content: 'üëë ELITE'; position: absolute; top: 10px; right: 10px; background: linear-gradient(135deg, var(--gold), var(--warning)); color: #000; padding: 6px 15px; border-radius: 12px; font-weight: 900; font-size: 0.8rem; }
        .signal-header { display: flex; justify-content: space-between; margin-bottom: 15px; padding-bottom: 12px; border-bottom: 2px solid #1a1a1a; }
        .signal-pair { font-family: 'Orbitron', sans-serif; font-size: 1.8rem; font-weight: 900; color: var(--gold); }
        .signal-score { font-family: 'Roboto Mono', monospace; font-size: 1.6rem; font-weight: 900; color: var(--gold); }
        .profit-box { background: rgba(255,215,0,0.15); border: 3px solid var(--gold); border-radius: 12px; padding: 15px; text-align: center; margin: 12px 0; }
        .profit-box .amount { font-family: 'Orbitron', monospace; font-size: 1.8rem; font-weight: 900; color: var(--gold); text-shadow: 0 0 20px rgba(255,215,0,0.8); }
        .btn-execute { width: 100%; padding: 15px; background: linear-gradient(135deg, var(--gold), var(--warning)); border: none; border-radius: 12px; color: #000; font-weight: 900; font-size: 1.1rem; cursor: pointer; transition: all 0.3s; }
        .btn-execute:hover { transform: scale(1.05); }
        .empty { text-align: center; padding: 50px 20px; color: #666; }
        @media (max-width: 1800px) { .main-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üëë ULTIMATE PRO SYSTEM</h1>
            <div class="subtitle">100% Math√©matiques ‚Ä¢ GitHub Persistance ‚Ä¢ Telegram Live</div>
            <div class="controls">
                <button class="btn-control btn-start" id="btn-start" onclick="startSystem()">üöÄ START</button>
                <button class="btn-control btn-stop" id="btn-stop" onclick="stopSystem()" disabled>‚õî STOP</button>
            </div>
            <div class="status-indicator stopped" id="status">‚≠ï SYST√àME ARR√äT√â</div>
            <div class="features-grid">
                <div class="feature-badge">PERSISTANCE GITHUB</div>
                <div class="feature-badge">TELEGRAM LIVE</div>
                <div class="feature-badge">AUTO RESTART</div>
                <div class="feature-badge">R√âGIME AUTO</div>
                <div class="feature-badge">ANTI-SPOOFING</div>
                <div class="feature-badge">100% HALAL</div>
            </div>
        </div>

        <div class="main-grid">
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <div class="card progress-card">
                    <h3 style="color: var(--gold);">üëë CHALLENGE 300‚Ç¨‚Üí10K</h3>
                    <div class="capital-display"><div class="value" id="capital">300‚Ç¨</div></div>
                    <div class="progress-bar"><div class="progress-fill" id="progress" style="width: 3%"></div></div>
                    <div style="text-align: center; font-size: 0.9rem; color: #aaa; margin-top: 8px;" id="progress-text">3.0% ‚Ä¢ J1/30</div>
                    <div class="stats-grid">
                        <div class="stat-box"><div class="label">Signals</div><div class="value" id="sig-count">0</div></div>
                        <div class="stat-box"><div class="label">Trades</div><div class="value" id="trades">0</div></div>
                        <div class="stat-box"><div class="label">Win Rate</div><div class="value" id="winrate">--%</div></div>
                        <div class="stat-box"><div class="label">Profit</div><div class="value" id="profit">+0‚Ç¨</div></div>
                    </div>
                </div>
                <div class="card">
                    <h3 style="color: var(--secondary);">üì± TELEGRAM</h3>
                    <div style="background: rgba(0,212,255,0.1); border: 1px solid var(--secondary); border-radius: 10px; padding: 15px; margin-bottom: 12px;">
                        <div style="font-weight: 700; color: var(--secondary); margin-bottom: 8px;">Status</div>
                        <div style="font-size: 0.85rem; color: #aaa;" id="telegram-info">Pr√™t</div>
                    </div>
                    <div style="background: rgba(0,212,255,0.1); border: 1px solid var(--secondary); border-radius: 10px; padding: 15px;">
                        <div style="font-weight: 700; color: var(--secondary); margin-bottom: 8px;">Notifications</div>
                        <div style="font-size: 1.5rem; font-family: 'Orbitron', sans-serif; color: var(--secondary); text-align: center;" id="notif-count">0</div>
                    </div>
                </div>
            </div>

            <div style="display: flex; flex-direction: column; gap: 15px;">
                <div class="card console-card">
                    <h3 style="color: var(--secondary);">üì° CONSOLE</h3>
                    <div class="console" id="console">
                        <div class="log info"><span class="time">[00:00:00]</span> Syst√®me initialis√©</div>
                        <div class="log warning"><span class="time">[00:00:00]</span> Appuyez sur START</div>
                    </div>
                </div>
                <div class="card signals-card">
                    <h3 style="color: var(--gold); font-size: 1.4rem;">üëë SIGNALS ELITE</h3>
                    <div class="signals-grid" id="signals">
                        <div class="empty"><div style="font-size: 4rem; margin-bottom: 15px;">üëë</div><div>En attente...</div></div>
                    </div>
                </div>
            </div>

            <div style="display: flex; flex-direction: column; gap: 15px;">
                <div class="card">
                    <h3 style="color: var(--primary);">üéØ TOP 5</h3>
                    <div id="ranking"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
const TELEGRAM_BOT_TOKEN='8317338475:AAH4_etAd7VsUWHk_4M-HNWZtWp69pAEEpo';
const TELEGRAM_CHAT_ID=1719073848;
const PAIRS=['BTCUSDT','ETHUSDT','SOLUSDT','BNBUSDT','XRPUSDT','ADAUSDT','AVAXUSDT','DOGEUSDT','DOTUSDT','MATICUSDT','LINKUSDT','UNIUSDT','ATOMUSDT','LTCUSDT','NEARUSDT','ALGOUSDT','VETUSDT','ICPUSDT','FILUSDT','HBARUSDT','APTUSDT','ARBUSDT','OPUSDT','INJUSDT','SUIUSDT','SEIUSDT','TAOUSDT','RENDERUSDT','TIAUSDT','PEPEUSDT'];
const KEY='ultimate_pro_final';
let systemRunning=false,scanInterval=null,notificationsSent=0;
let state={capital:300,day:1,trades:0,profit:0,wins:0,history:{},btcData:null,signals:[],regime:'neutral',ranking:[],running:false};
function saveState(){try{localStorage.setItem(KEY,JSON.stringify({...state,running:systemRunning,notificationsSent,lastSave:Date.now()}))}catch(e){}}
function loadState(){try{const s=localStorage.getItem(KEY);if(!s)return;const d=JSON.parse(s);state.capital=d.capital||300;state.trades=d.trades||0;state.profit=d.profit||0;state.wins=d.wins||0;state.history=d.history||{};notificationsSent=d.notificationsSent||0;log('‚úÖ √âtat restaur√©','success');if(d.running){log('üîÑ Red√©marrage...','warning');setTimeout(()=>startSystem(true),2000)}}catch(e){}}
function log(m,t='info'){const c=document.getElementById('console');if(!c)return;const time=new Date().toLocaleTimeString('fr-FR',{hour:'2-digit',minute:'2-digit',second:'2-digit'});const d=document.createElement('div');d.className=`log ${t}`;d.innerHTML=`<span class="time">[${time}]</span> ${m}`;c.appendChild(d);c.scrollTop=c.scrollHeight;if(c.children.length>150)c.removeChild(c.firstChild)}
async function sendTelegramMessage(m){try{const r=await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({chat_id:TELEGRAM_CHAT_ID,text:m,parse_mode:'Markdown'})});const d=await r.json();if(d.ok){notificationsSent++;const n=document.getElementById('notif-count');if(n)n.textContent=notificationsSent;saveState();return true}return false}catch(e){return false}}
async function sendSignalNotification(s){return await sendTelegramMessage(`üëë **SIGNAL ELITE**\n\nüíé **${s.symbol}** | Score: **${s.indicators.score.toFixed(0)}%**\n\nüìä **INDICATEURS:**\n‚Ä¢ RSI: ${s.indicators.rsi.value.toFixed(1)}\n‚Ä¢ Volume: ${s.indicators.volume.value.toFixed(0)}%\n‚Ä¢ Momentum: ${s.indicators.momentum.value>0?'+':''}${s.indicators.momentum.value.toFixed(2)}%\n\n‚è±Ô∏è **DUR√âE:** ${s.duration.best}\n\nüí∞ **TRADING:**\n‚Ä¢ Prix: $${s.currentPrice.toFixed(4)}\n‚Ä¢ Profit: **+${s.estimatedProfit.toFixed(2)}‚Ç¨**\n‚Ä¢ Stop: -${s.stopLoss.toFixed(2)}%\n\nüìã **ENTR√âE:**\n1Ô∏è‚É£ Phase 1 (50%): $${s.entryLevels.entry1.price.toFixed(4)}\n2Ô∏è‚É£ Phase 2 (25%): $${s.entryLevels.entry2.price.toFixed(4)}\n3Ô∏è‚É£ Phase 3 (25%): $${s.entryLevels.entry3.price.toFixed(4)}\n\n‚ö° **BINANCE SPOT**`)}
async function startSystem(silent=false){if(systemRunning)return;systemRunning=true;state.running=true;saveState();document.getElementById('btn-start').disabled=true;document.getElementById('btn-stop').disabled=false;document.getElementById('status').className='status-indicator running';document.getElementById('status').textContent='‚úÖ EN MARCHE';if(!silent){log('üöÄ D√©marr√©','success');await sendTelegramMessage('üöÄ **SYST√àME D√âMARR√â**\n\nScanning actif...')}else{log('üîÑ Restaur√©','success')}setTimeout(scan,2000);if(scanInterval)clearInterval(scanInterval);scanInterval=setInterval(scan,60000)}
async function stopSystem(){if(!systemRunning)return;systemRunning=false;state.running=false;saveState();if(scanInterval)clearInterval(scanInterval);document.getElementById('btn-start').disabled=false;document.getElementById('btn-stop').disabled=true;document.getElementById('status').className='status-indicator stopped';document.getElementById('status').textContent='‚õî ARR√äT√â';log('‚õî Arr√™t√©','warning');await sendTelegramMessage('‚õî **SYST√àME ARR√äT√â**')}
async function fetchBinance(){try{const[p,t]=await Promise.all([fetch('https://api.binance.com/api/v3/ticker/price'),fetch('https://api.binance.com/api/v3/ticker/24hr')]);const prices=await p.json(),tickers=await t.json();const data={};PAIRS.forEach(sym=>{const pr=prices.find(x=>x.symbol===sym),ti=tickers.find(x=>x.symbol===sym);if(pr&&ti)data[sym]={price:parseFloat(pr.price),volume:parseFloat(ti.volume),priceChange:parseFloat(ti.priceChangePercent),high:parseFloat(ti.highPrice),low:parseFloat(ti.lowPrice),quoteVolume:parseFloat(ti.quoteVolume)}});return data}catch(e){return null}}
function updateHistory(sym,data){if(!state.history[sym])state.history[sym]=[];state.history[sym].push({price:data.price,volume:data.volume,high:data.high,low:data.low,timestamp:Date.now()});if(state.history[sym].length>30)state.history[sym].shift()}
function calcRSI(sym){const h=state.history[sym];if(!h||h.length<15)return null;let g=0,l=0;for(let i=h.length-14;i<h.length;i++){const c=h[i].price-h[i-1].price;if(c>0)g+=c;else l+=Math.abs(c)}const ag=g/14,al=l/14;if(al===0)return 100;return 100-(100/(1+ag/al))}
function calcATR(sym){const h=state.history[sym];if(!h||h.length<15)return null;let s=0;for(let i=h.length-14;i<h.length;i++)s+=Math.max(h[i].high-h[i].low,Math.abs(h[i].high-h[i-1].price),Math.abs(h[i].low-h[i-1].price));return s/14}
function calcADX(sym){const h=state.history[sym];if(!h||h.length<15)return null;let s=0;for(let i=h.length-14;i<h.length;i++){const high=h[i].high,low=h[i].low,pc=h[i-1].price,tr=Math.max(high-low,Math.abs(high-pc),Math.abs(low-pc)),up=high-h[i-1].high,down=h[i-1].low-low,pdm=up>down&&up>0?up:0,mdm=down>up&&down>0?down:0;if(tr>0){const pdi=(pdm/tr)*100,mdi=(mdm/tr)*100,dx=Math.abs(pdi-mdi)/(pdi+mdi)*100;s+=dx}}return s/14}
function calcMomentum(sym){const h=state.history[sym];if(!h||h.length<10)return null;return((h[h.length-1].price-h[h.length-10].price)/h[h.length-10].price)*100}
function calcVolumeTrend(sym,cv){const h=state.history[sym];if(!h||h.length<10)return null;return(cv/(h.reduce((s,x)=>s+x.volume,0)/h.length))*100}
function detectRegime(){if(!state.btcData)return'neutral';const adx=calcADX('BTCUSDT'),atr=calcATR('BTCUSDT'),mom=calcMomentum('BTCUSDT');if(!adx||!atr||!mom)return'neutral';const vol=(atr/state.btcData.price)*100;if(adx>25&&mom>2)return'strong_bull';if(adx>25&&mom<-2)return'strong_bear';if(vol>3)return'high_volatility';if(adx<20&&Math.abs(mom)<1)return'ranging';return'neutral'}
function calcDecorrelation(sym){if(sym==='BTCUSDT')return 0;const bm=calcMomentum('BTCUSDT'),sm=calcMomentum(sym);if(!bm||!sm)return null;if(Math.abs(bm)>1&&Math.abs(sm)<0.5)return Math.abs(bm-sm);return 0}
function estimateDuration(sym){const m=calcMomentum(sym),h=state.history[sym];if(!m||!h||h.length<10)return null;const v=Math.abs(m),a=h.length>=15?Math.abs(h[h.length-1].price-h[h.length-5].price)/h[h.length-5].price*100:0;const s5=(a>0.3&&v>0.5)?85:40,s15=v>1?80:45,s30=v>0.5?75:35;return{'5min':s5,'15min':s15,'30min':s30,'60min':70,best:s5>s15?'5-10min':s15>s30?'15-20min':'30min+'}}
function checkSpoofing(d){const vr=d.quoteVolume/(d.price*d.volume);if(vr<0.8)return{safe:false,reason:'Volume suspect'};if(d.quoteVolume<10000000)return{safe:false,reason:'Liquidit√© faible'};const vol=((d.high-d.low)/d.price)*100;if(vol>10)return{safe:false,reason:'Volatilit√© extr√™me'};return{safe:true,reason:'Volume r√©el ‚úì'}}
function calcOptimalScore(sym,d){if(!state.btcData)return 0;const atr=calcATR(sym),mom=calcMomentum(sym),bm=calcMomentum('BTCUSDT');if(!atr||!mom||!bm)return 0;const vp=(atr/d.price)*100,vs=vp>=0.8&&vp<=2.5?30:vp>=0.5&&vp<=3?20:10,vols=d.quoteVolume>100000000?30:d.quoteVolume>50000000?20:10,dec=Math.abs(mom-bm),ds=dec>3?40:dec>2?30:dec>1?20:10;return vs+vols+ds}
function calcConvergence(sym,d){const rsi=calcRSI(sym),atr=calcATR(sym),adx=calcADX(sym),vt=calcVolumeTrend(sym,d.volume),mom=calcMomentum(sym),dec=calcDecorrelation(sym);if(!rsi||!atr||!adx||!vt||!mom)return null;const vp=(atr/d.price)*100;if(vp<0.3||vp>5)return null;const sc=checkSpoofing(d);if(!sc.safe)return null;let rs=0;if(rsi<30)rs=1;else if(rsi>40&&rsi<60&&mom>0)rs=0.7;let vs=vt>150?1:0,ms=mom>0.5?1:0,as=adx>20?1:0,ds=dec&&dec>2?1:0;let w={rsi:0.2,volume:0.2,momentum:0.2,adx:0.2,decorrelation:0.2};if(state.regime==='strong_bull'||state.regime==='strong_bear')w={rsi:0.15,volume:0.25,momentum:0.35,adx:0.15,decorrelation:0.1};else if(state.regime==='ranging')w={rsi:0.35,volume:0.35,momentum:0.1,adx:0.1,decorrelation:0.1};const score=(rs*w.rsi+vs*w.volume+ms*w.momentum+as*w.adx+ds*w.decorrelation)*100;return{rsi:{value:rsi},volume:{value:vt},momentum:{value:mom},adx:{value:adx},volatility:{value:vp},decorrelation:dec||0,score,convergent:score>=70&&vs===1,spoofCheck:sc}}
function calcEntryLevels(p){return{entry1:{pct:50,price:p},entry2:{pct:25,price:p*1.003},entry3:{pct:25,price:p*1.006}}}
async function scan(){if(!systemRunning)return;log('üîç Scanning...','info');const d=await fetchBinance();if(!d||!d['BTCUSDT'])return;state.btcData=d['BTCUSDT'];updateHistory('BTCUSDT',state.btcData);state.regime=detectRegime();state.ranking=[];const anom=[];for(const sym of PAIRS){if(!d[sym])continue;updateHistory(sym,d[sym]);const sc=calcOptimalScore(sym,d[sym]);state.ranking.push({symbol:sym.replace('USDT',''),score:sc,volume:d[sym].quoteVolume/1000000,momentum:calcMomentum(sym)||0});const dec=calcDecorrelation(sym);if(dec&&dec>2)anom.push({symbol:sym.replace('USDT',''),decorrelation:dec})}state.ranking.sort((a,b)=>b.score-a.score);renderRanking();state.signals=[];const top=state.ranking.slice(0,5).map(r=>r.symbol+'USDT');for(const sym of top){if(!d[sym])continue;const conv=calcConvergence(sym,d[sym]);if(!conv||!conv.convergent)continue;const dur=estimateDuration(sym);if(!dur)continue;const atr=calcATR(sym),slp=(atr/d[sym].price)*100*2,ra=state.capital*0.005,ps=Math.min(ra/(slp/100),state.capital),tp=conv.momentum.value*0.6,el=calcEntryLevels(d[sym].price),ap=(ps*0.5*tp/100)+(ps*0.25*(tp+0.3)/100)+(ps*0.25*(tp+0.6)/100),fees=ps*0.003*3,np=ap-fees;if(np>0){const sig={symbol:sym.replace('USDT',''),fullSym:sym,indicators:conv,duration:dur,currentPrice:d[sym].price,estimatedProfit:np,stopLoss:slp,targetProfit:tp,positionSize:ps,entryLevels:el,isElite:conv.score>=85};state.signals.push(sig);log(`üëë ${sym} Score:${conv.score.toFixed(0)}%`,'success');await sendSignalNotification(sig)}}const sc=document.getElementById('sig-count');if(sc)sc.textContent=state.signals.length;render();saveState();log(`‚úÖ ${state.signals.length} signals`,'success')}
function renderRanking(){const c=document.getElementById('ranking');if(!c)return;c.innerHTML='';state.ranking.slice(0,10).forEach((item,i)=>{const d=document.createElement('div');d.style.cssText='background:rgba(0,255,136,0.05);border:2px solid #1a1a1a;border-radius:10px;padding:12px;margin-bottom:10px;';if(i<3)d.style.cssText+='border-color:var(--gold);background:rgba(255,215,0,0.1);';d.innerHTML=`<div style="display:flex;justify-content:space-between;margin-bottom:8px;"><div style="font-weight:900;font-size:1.2rem;">#${i+1} ${item.symbol}</div><div style="font-family:'Roboto Mono',monospace;font-weight:900;color:${i<3?'var(--gold)':'var(--primary)'};">${item.score}</div></div><div style="display:flex;justify-content:space-between;font-size:0.75rem;color:#aaa;"><div>Vol:${item.volume.toFixed(0)}M</div><div>Mom:${item.momentum>0?'+':''}${item.momentum.toFixed(2)}%</div></div>`;c.appendChild(d)})}
function render(){const c=document.getElementById('signals');if(!c)return;if(state.signals.length===0){c.innerHTML='<div class="empty"><div style="font-size:4rem;margin-bottom:15px;">‚è≥</div><div>En attente...</div></div>';return}c.innerHTML='';state.signals.forEach((s,i)=>{const card=document.createElement('div');card.className=`signal-card ${s.isElite?'elite':''}`;card.innerHTML=`<div class="signal-header"><div class="signal-pair">${s.symbol}</div><div class="signal-score">${s.indicators.score.toFixed(0)}%</div></div><div style="background:rgba(255,0,128,0.1);border:2px solid var(--accent);border-radius:10px;padding:12px;margin-bottom:12px;text-align:center;"><div style="font-size:0.8rem;color:var(--accent);font-weight:700;margin-bottom:8px;">‚è±Ô∏è DUR√âE</div><div style="font-family:'Orbitron',sans-serif;font-size:1.5rem;font-weight:900;color:var(--accent);">${s.duration.best}</div></div><div class="profit-box"><div style="font-size:0.8rem;color:#888;margin-bottom:6px;">Profit (+${s.targetProfit.toFixed(1)}%)</div><div class="amount">+${s.estimatedProfit.toFixed(2)}‚Ç¨</div></div><div style="text-align:center;font-size:0.85rem;color:#aaa;margin-bottom:12px;">üì± Notification envoy√©e!</div><button class="btn-execute" onclick="execute(${i})">‚úÖ EX√âCUT√â</button>`;c.appendChild(card)})}
function execute(i){const s=state.signals[i],p=s.estimatedProfit;state.capital+=p;state.trades++;state.profit+=p;state.wins++;log(`‚úÖ ${s.symbol} +${p.toFixed(2)}‚Ç¨`,'success');updateUI();saveState();state.signals.splice(i,1);render()}
function updateUI(){const prog=(state.capital/10000)*100;const pe=document.getElementById('progress'),pte=document.getElementById('progress-text'),ce=document.getElementById('capital'),te=document.getElementById('trades'),pfe=document.getElementById('profit'),we=document.getElementById('winrate');if(pe)pe.style.width=`${prog}%`;if(pte)pte.textContent=`${prog.toFixed(1)}% ‚Ä¢ J${state.day}/30`;if(ce)ce.textContent=`${state.capital.toFixed(0)}‚Ç¨`;if(te)te.textContent=state.trades;if(pfe)pfe.textContent=`+${state.profit.toFixed(0)}‚Ç¨`;if(state.trades>0&&we)we.textContent=`${((state.wins/state.trades)*100).toFixed(0)}%`}
setInterval(()=>{if(systemRunning)saveState()},30000);
window.addEventListener('beforeunload',saveState);
document.addEventListener('DOMContentLoaded',()=>{log('üëë ULTIMATE PRO','success');log('üíæ Persistance active','success');log('üì± Telegram: '+TELEGRAM_CHAT_ID,'info');updateUI();const ne=document.getElementById('notif-count');if(ne)ne.textContent=notificationsSent;loadState();if(!systemRunning)log('‚ö° Appuyez sur START','warning')});
    </script>
</body>
</html>
